<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NextGear | Image Resizer</title>
</head>

<body>

    <div id="app-header"></div>

    <main class="main">
        <div class="header-area">
            <div class="page-info">
                <h1 data-i18n="tool_title">ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø©</h1>
                <p data-i18n="tool_desc">ØºÙŠØ± Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ± Ø¨Ø¯Ù‚Ø© ÙˆØ³Ø±Ø¹Ø©.</p>
            </div>
        </div>

        <div class="tool-view active" style="display:block; max-width:800px; margin:0 auto">

            <div class="field">
                <label data-i18n="input_label">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø©:</label>
                <input type="file" id="imgInput" accept="image/*">
            </div>

            <div style="display:flex; gap:15px">
                <div class="field" style="flex:1">
                    <label>Ø§Ù„Ø¹Ø±Ø¶ (Width)</label>
                    <input type="number" id="wInput" placeholder="px">
                </div>
                <div class="field" style="flex:1">
                    <label>Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ (Height)</label>
                    <input type="number" id="hInput" placeholder="Auto" disabled>
                </div>
            </div>

            <button class="run-btn" onclick="runResize()" data-i18n="action_btn">ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù…</button>

            <div class="output-area" id="output" style="display:none; text-align:center">
                <div id="outputVal"></div>
            </div>

        </div>
    </main>

    <div id="app-footer"></div>
    <script src="../../global.js"></script>

    <script>
        const pageDict = {
            'ar': { 'tool_title': 'ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø©', 'tool_desc': 'ØªØµØºÙŠØ± Ø£Ùˆ ØªÙƒØ¨ÙŠØ± Ø§Ù„ØµÙˆØ±.', 'input_label': 'Ù…Ù„Ù Ø§Ù„ØµÙˆØ±Ø©', 'action_btn': 'Ù…Ø¹Ø§Ù„Ø¬Ø©' },
            'en': { 'tool_title': 'Image Resizer', 'tool_desc': 'Resize images easily.', 'input_label': 'Image File', 'action_btn': 'Process' }
        };

        window.addEventListener('DOMContentLoaded', () => {
            const lang = window.NextGear.lang;
            const dict = pageDict[lang] || pageDict['en'];
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (dict[key]) el.innerText = dict[key];
            });
        });

        async function runResize() {
            const file = document.getElementById('imgInput').files[0];
            const width = parseInt(document.getElementById('wInput').value);

            if (!file || !width) return alert('Please select image and width');

            const btn = document.querySelector('.run-btn');
            btn.innerHTML = 'â³...';

            const resUrl = await window.processImage(file, (ctx, cvs, img) => {
                const scale = width / img.width;
                cvs.width = width;
                cvs.height = img.height * scale;
                ctx.drawImage(img, 0, 0, cvs.width, cvs.height);
                return cvs.toDataURL('image/jpeg', 0.9);
            });

            document.getElementById('output').style.display = 'block';
            if (resUrl.startsWith('data:')) {
                document.getElementById('outputVal').innerHTML = `
                    <img src="${resUrl}" style="max-width:100%; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.1)">
                    <br><br>
                    <a href="${resUrl}" download="resized.jpg" class="pro-btn">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©</a>
                `;
            } else {
                document.getElementById('outputVal').innerText = resUrl;
            }
            btn.innerHTML = pageDict[window.NextGear.lang]?.action_btn || 'Process';
        }
    </script>
</body>

</html>