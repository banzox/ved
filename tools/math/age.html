<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NextGear | Age Calculator</title>
</head>

<body>

    <div id="app-header"></div>

    <main class="main">
        <div class="header-area">
            <div class="page-info">
                <h1 data-i18n="tool_title">حاسبة العمر</h1>
                <p data-i18n="tool_desc">احسب عمرك بالتفصيل (السنين، الشهور، الأيام).</p>
            </div>
        </div>

        <div class="tool-view active" style="display:block; max-width:800px; margin:0 auto">

            <div class="field">
                <label data-i18n="input_label">تاريخ الميلاد:</label>
                <input type="date" id="dobInput">
            </div>

            <button class="run-btn" onclick="calcAge()" data-i18n="action_btn">احسب العمر</button>

            <div class="output-area" id="output" style="display:none">
                <div class="output-val" id="outputVal"></div>
            </div>

        </div>
    </main>

    <div id="app-footer"></div>
    <script src="../../global.js"></script>

    <script>
        const pageDict = {
            'ar': { 'tool_title': 'حاسبة العمر', 'tool_desc': 'تعرف على عمرك الحقيقي.', 'input_label': 'تاريخ الميلاد', 'action_btn': 'احسب', 'res_y': 'سنة', 'res_m': 'شهر', 'res_d': 'يوم' },
            'en': { 'tool_title': 'Age Calculator', 'tool_desc': 'Calculate your exact age.', 'input_label': 'Date of Birth', 'action_btn': 'Calculate', 'res_y': 'Years', 'res_m': 'Months', 'res_d': 'Days' }
        };

        window.addEventListener('DOMContentLoaded', () => {
            const lang = window.NextGear.lang;
            const dict = pageDict[lang] || pageDict['en'];
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (dict[key]) el.innerText = dict[key];
            });
        });

        function calcAge() {
            const dobVal = document.getElementById('dobInput').value;
            if (!dobVal) return;

            const today = new Date();
            const birthDate = new Date(dobVal);

            let years = today.getFullYear() - birthDate.getFullYear();
            let months = today.getMonth() - birthDate.getMonth();
            let days = today.getDate() - birthDate.getDate();

            if (days < 0) {
                months--;
                days += new Date(today.getFullYear(), today.getMonth(), 0).getDate();
            }
            if (months < 0) {
                years--;
                months += 12;
            }

            const lang = window.NextGear.lang;
            const dict = pageDict[lang] || pageDict['en'];

            document.getElementById('output').style.display = 'block';
            document.getElementById('outputVal').innerHTML = `
                <div style="font-size:2.5rem; color:var(--primary); font-weight:bold; margin-bottom:10px">
                    ${years} <span style="font-size:1.5rem">${dict['res_y']}</span>
                </div>
                <div style="color:#64748b; font-size:1.2rem">
                    ${months} ${dict['res_m']} | ${days} ${dict['res_d']}
                </div>
            `;
        }
    </script>
</body>

</html>